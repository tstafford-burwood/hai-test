view: amr_split_flat {
sql_table_name: `hai-looker.cdph_hai_combined.master`
  ;;

dimension: amr_gene_categories {
  type: string
  sql: CASE
         WHEN STARTS_WITH(${TABLE}.amr_genes, "aac") IS TRUE THEN "aac"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "aad") IS TRUE THEN "aad"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "aba") IS TRUE THEN "aba"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "acr") IS TRUE THEN "acr"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "ade") IS TRUE THEN "ade"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "amv") IS TRUE THEN "amv"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "ant") IS TRUE THEN "ant"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "aph") IS TRUE THEN "aph"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "arm") IS TRUE THEN "arm"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "arr") IS TRUE THEN "arr"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "blaACT") IS TRUE THEN "blaACT"
         WHEN STARTS_WITH(${TABLE}.amr_genes, "blaADC") IS TRUE THEN "blaADC"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "blaAXC") IS TRUE THEN "blaAXC"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "blaCARB") IS TRUE THEN "blaCARB"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "blaCKO") IS TRUE THEN "blaCKO"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "blaCMY") IS TRUE THEN "blaCMY"
         WHEN STARTS_WITH(${TABLE}.amr_genes, "blaCTX") IS TRUE THEN "blaCTX"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "blaDHA") IS TRUE THEN "blaDHA"
           WHEN STARTS_WITH(${TABLE}.amr_genes, "blaEC") IS TRUE THEN "blaEC"
           WHEN ${TABLE}.amr_genes = "blaI" THEN "blaI"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaIMP") IS TRUE THEN "blaIMP"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaKPC") IS TRUE THEN "blaKPC"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaL1") IS TRUE THEN "blaL1"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaNDM") IS TRUE THEN "blaNDM"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaOXA") IS TRUE THEN "blaOXA"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaOXY") IS TRUE THEN "blaOXY"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaPDC") IS TRUE THEN "blaPDC"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaPER") IS TRUE THEN "blaPER"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaPLA") IS TRUE THEN "blaPLA"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaPME") IS TRUE THEN "blaPME"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaR") IS TRUE THEN "blaR"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaSFO") IS TRUE THEN "blaSFO"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaSHV") IS TRUE THEN "blaSHV"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaSME") IS TRUE THEN "blaSME"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaSRT") IS TRUE THEN "blaSRT"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaTEM") IS TRUE THEN "blaTEM"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaVEB") IS TRUE THEN "blaVEB"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaVIM") IS TRUE THEN "blaVIM"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "blaZ") IS TRUE THEN "blaZ"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "ble") IS TRUE THEN "ble"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "cat") IS TRUE THEN "cat"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "cml") IS TRUE THEN "cml"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "crp") IS TRUE THEN "crp"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "dfr") IS TRUE THEN "dfr"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "emr") IS TRUE THEN "emr"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "ere") IS TRUE THEN "ere"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "erm") IS TRUE THEN "erm"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "floR") IS TRUE THEN "floR"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "fos") IS TRUE THEN "fos"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "ftsl") IS TRUE THEN "ftsl"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "glpt") IS TRUE THEN "glpt"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "gyr") IS TRUE THEN "gyr"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "kde") IS TRUE THEN "kde"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "lsa") IS TRUE THEN "lsa"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "mcr") IS TRUE THEN "mcr"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "mdt") IS TRUE THEN "mdt"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "mec") IS TRUE THEN "mec"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "mep") IS TRUE THEN "mep"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "mex") IS TRUE THEN "mex"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "mph") IS TRUE THEN "mph"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "msr") IS TRUE THEN "msr"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "mur") IS TRUE THEN "mur"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "oqx") IS TRUE THEN "oqx"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "par") IS TRUE THEN "par"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "pmr") IS TRUE THEN "pmr"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "qep") IS TRUE THEN "qep"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "qnr") IS TRUE THEN "qnr"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "rmt") IS TRUE THEN "rmt"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "sat") IS TRUE THEN "sat"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "sde") IS TRUE THEN "sde"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "sme") IS TRUE THEN "sme"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "smf") IS TRUE THEN "smf"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "sul") IS TRUE THEN "sul"
          WHEN STARTS_WITH(${TABLE}.amr_genes, "tet") IS TRUE THEN "tet"
          ELSE "No Category" END;;
  drill_fields: [amr_genes, drug_classes, specimen_count]
}

dimension: drug_class {
type: string
sql: (split(${amr_gene_and_drug_class}, ':'))[safe_ordinal(2)] ;;
drill_fields: [subclasses, amr_genes, specimen_count]
}

dimension: subclasses {
type: string
sql: (split(${TABLE}.subclasses, ':'))[safe_ordinal(2)] ;;
drill_fields: [amr_genes]
}

dimension: subclass {
type: string
sql: CASE WHEN ${drug_classes} = "AMINOGLYCOSIDE" AND ${subclasses} = "AMIKACIN/KANAMYCIN" AND(${TABLE}.amr_genes = "aph(3')-IIIa" OR STARTS_WITH(${TABLE}.amr_genes, "aph(3')-VI") IS TRUE) THEN "AMIKACIN/KANAMYCIN"
    WHEN STARTS_WITH(${TABLE}.amr_genes, "aac(6')-Ib-c") IS TRUE AND ${drug_classes} = "AMINOGLYCOSIDE/QUINOLONE" AND ${subclasses} = "AMIKACIN/KANAMYCIN/QUINOLONE/TOBRAMYCIN" THEN "AMIKACIN/KANAMYCIN/QUINOLONE/TOBRAMYCIN"
    WHEN ${drug_classes} = "AMINOGLYCOSIDE" AND ${subclasses} = "AMIKACIN/KANAMYCIN/TOBRAMYCIN" AND(${TABLE}.amr_genes = "aac(6')-Ib" OR ${TABLE}.amr_genes = "aac(6')-Ib3" OR ${TABLE}.amr_genes = "aac(6')-Il") THEN "AMIKACIN/KANAMYCIN/TOBRAMYCIN"
    WHEN ${drug_classes} = "AMINOGLYCOSIDE" AND ${subclasses} = "AMINOGLYCOSIDE" AND(${TABLE}.amr_genes = "aac(6')" OR ${TABLE}.amr_genes = "aph(6)" OR STARTS_WITH(${TABLE}.amr_genes, "aac(6')-2") IS TRUE OR STARTS_WITH(${TABLE}.amr_genes, "rmt") IS TRUE) THEN "AMINOGLYCOSIDE"
    WHEN ${drug_classes} = "BETA-LACTAM" AND ${subclasses} = "BETA-LACTAM" AND(${TABLE}.amr_genes = "blaCARB-2" OR ${TABLE}.amr_genes = "blaCKO" OR ${TABLE}.amr_genes = "blaEC" OR ${TABLE}.amr_genes = "blaI" OR ${TABLE}.amr_genes = "blaOXA" OR ${TABLE}.amr_genes = "blaOXA-114a" OR ${TABLE}.amr_genes = "blaOXA-2" OR STARTS_WITH(${TABLE}.amr_genes, "blaOXA-39") IS TRUE OR ${TABLE}.amr_genes = "blaOXA-488" OR ${TABLE}.amr_genes = "blaOXA-834" OR STARTS_WITH(${TABLE}.amr_genes, "blaOXA-84") IS TRUE OR ${TABLE}.amr_genes = "blaOXA-9" OR STARTS_WITH(${TABLE}.amr_genes, "blaOXY") IS TRUE OR ${TABLE}.amr_genes = "blaPLA-3" OR ${TABLE}.amr_genes = "blaR1" OR ${TABLE}.amr_genes = "blaSFO-1" OR ${TABLE}.amr_genes = "blaSHV-1" OR ${TABLE}.amr_genes = "blaSHV-11" OR STARTS_WITH(${TABLE}.amr_genes, "blaT") IS TRUE OR ${TABLE}.amr_genes = "blaZ") THEN "BETA-LACTAM"
    WHEN ${TABLE}.amr_genes = "ble" AND ${drug_classes} = "BLEOMYCIN" AND ${subclasses} = "BLEOMYCIN" THEN "BLEOMYCIN"
    WHEN ${drug_classes} = "BETA-LACTAM" AND ${subclasses} = "CARBAPENEM" AND(STARTS_WITH(${TABLE}.amr_genes, "blaAX") IS TRUE OR ${TABLE}.amr_genes = "blaIMP-62" OR STARTS_WITH(${TABLE}.amr_genes, "blaK") IS TRUE OR ${TABLE}.amr_genes = "blaL1"  OR ${TABLE}.amr_genes = "blaOXA-181" OR STARTS_WITH(${TABLE}.amr_genes, "blaN") IS TRUE OR STARTS_WITH(${TABLE}.amr_genes, "blaOXA-23") IS TRUE OR ${TABLE}.amr_genes = "blaOXA-407" OR ${TABLE}.amr_genes = "blaOXA-66" OR ${TABLE}.amr_genes = "blaSME-4" OR ${TABLE}.amr_genes = "blaVIM-2") THEN "CARBAPENEM"
    WHEN ${drug_classes} = "BETA-LACTAM" AND ${subclasses} = "CEPHALOSPORIN" AND(STARTS_WITH(${TABLE}.amr_genes, "blaAC") IS TRUE OR STARTS_WITH(${TABLE}.amr_genes, "blaAD") IS TRUE OR STARTS_WITH(${TABLE}.amr_genes, "blaCM") IS TRUE OR STARTS_WITH(${TABLE}.amr_genes, "blaCT") IS TRUE OR ${TABLE}.amr_genes = "blaDHA-1" OR ${TABLE}.amr_genes = "blaOXA-1" OR ${TABLE}.amr_genes = "blaOXA-10" OR STARTS_WITH(${TABLE}.amr_genes, "blaPD") IS TRUE OR ${TABLE}.amr_genes = "blaPER-1" OR ${TABLE}.amr_genes = "blaPME-1" OR ${TABLE}.amr_genes = "blaSHV-12" OR ${TABLE}.amr_genes = "blaSRT" OR STARTS_WITH(${TABLE}.amr_genes, "blaVE") IS TRUE) THEN "CEPHALOSPORIN"
    WHEN ${drug_classes} = "PHENICOL" AND ${subclasses} = "CHLORAMPHENICOL" AND(STARTS_WITH(${TABLE}.amr_genes, "cat") IS TRUE OR STARTS_WITH(${TABLE}.amr_genes, "cml") IS TRUE) THEN "CHLORAMPHENICOL"
    WHEN ${TABLE}.amr_genes = "floR" AND ${drug_classes} = "PHENICOL" AND ${subclasses} = "CHLORAMPHENICOL/FLORFENICOL" THEN "CHLORAMPHENICOL/FLORFENICOL"
    WHEN ${TABLE}.amr_genes = "mcr-9.1" AND ${drug_classes} = "COLISTIN" AND ${subclasses} = "COLISTIN" THEN "COLISTIN"
    WHEN ${drug_classes} = "EFFLUX" AND ${subclasses} = "EFFLUX" AND(${TABLE}.amr_genes = "acrF" OR ${TABLE}.amr_genes = "adeC" OR ${TABLE}.amr_genes = "amvA" OR STARTS_WITH(${TABLE}.amr_genes, "emr") IS TRUE OR ${TABLE}.amr_genes = "kdeA" OR ${TABLE}.amr_genes = "mdtM" OR ${TABLE}.amr_genes = "mepA" OR STARTS_WITH(${TABLE}.amr_genes, "mex") IS TRUE OR STARTS_WITH(${TABLE}.amr_genes, "sde") IS TRUE OR ${TABLE}.amr_genes = "smeF" OR ${TABLE}.amr_genes = "smfY") THEN "EFFLUX"
    WHEN ${TABLE}.amr_genes = "crpP" AND ${drug_classes} = "FLUOROQUINOLONE" AND ${subclasses} = "FLUOROQUINOLONE" THEN "FLUOROQUINOLONE"
    WHEN ${drug_classes} = "FOSFOMYCIN" AND ${subclasses} = "FOSFOMYCIN" AND(${TABLE}.amr_genes = "abaF" OR STARTS_WITH(${TABLE}.amr_genes, "fosA") IS TRUE OR ${TABLE}.amr_genes = "fosB") THEN "FOSFOMYCIN"
    WHEN ${drug_classes} = "AMINOGLYCOSIDE" AND ${subclasses} = "GENTAMICIN" AND (STARTS_WITH(${TABLE}.amr_genes, "aac(3") IS TRUE OR ${TABLE}.amr_genes = "aac(6')-Ib" OR ${TABLE}.amr_genes = "aac(6')-Ib'" OR ${TABLE}.amr_genes = "aac(6')-Ib4" OR ${TABLE}.amr_genes = "armA") THEN "GENTAMICIN"
    WHEN ${drug_classes} = "AMINOGLYCOSIDE" AND ${subclasses} = "GENTAMICIN/KANAMYCIN/TOBRAMYCIN" AND(${TABLE}.amr_genes = "aac(6')-IIa" OR ${TABLE}.amr_genes = "aac(6')-IIc" OR ${TABLE}.amr_genes = "ant(2'')-Ia") THEN "GENTAMICIN/KANAMYCIN/TOBRAMYCIN"
    WHEN ${drug_classes} = "AMINOGLYCOSIDE" AND ${subclasses} = "KANAMYCIN" AND(${TABLE}.amr_genes = "aph(3')-Ia" OR STARTS_WITH(${TABLE}.amr_genes, "aph(3')-II") IS TRUE) THEN "KANAMYCIN"
    WHEN ${TABLE}.amr_genes = "lsa(A)" AND ${drug_classes} = "LINCOSAMIDE/STREPTOGRAMIN" AND ${subclasses} = "LINCOSAMIDE/STREPTOGRAMIN" THEN "LINCOSAMIDE/STREPTOGRAMIN"
    WHEN ${drug_classes} = "MACROLIDE" AND ${subclasses} = "MACROLIDE" AND(STARTS_WITH(${TABLE}.amr_genes, "erm") IS TRUE OR ${TABLE}.amr_genes = "ere(A)" OR STARTS_WITH(${TABLE}.amr_genes, "mph") IS TRUE OR STARTS_WITH(${TABLE}.amr_genes, "msr") IS TRUE) THEN "MACROLIDE"
    WHEN STARTS_WITH(${TABLE}.amr_genes, "mec") IS TRUE AND ${drug_classes} = "BETA-LACTAM" AND ${subclasses} = "METHICILLIN" THEN "METHICILLIN"
    WHEN STARTS_WITH(${TABLE}.amr_genes, "oqx") IS TRUE AND ${drug_classes} = "PHENICOL/QUINOLONE" AND ${subclasses} = "PHENICOL/QUINOLONE" THEN "PHENICOL/QUINOLONE"
    WHEN ${drug_classes} = "QUINOLONE" AND ${subclasses} = "QUINOLONE" AND(STARTS_WITH(${TABLE}.amr_genes, "qep") IS TRUE OR STARTS_WITH(${TABLE}.amr_genes, "qnr") IS TRUE) THEN "QUINOLONE"
    WHEN STARTS_WITH(${TABLE}.amr_genes, "arr") IS TRUE AND ${drug_classes} = "RIFAMYCIN" AND ${subclasses} = "RIFAMYCIN" THEN "RIFAMYCIN"
    WHEN ${TABLE}.amr_genes = "ant(9)-Ia" AND ${drug_classes} = "AMINOGLYCOSIDE" AND ${subclasses} = "SPECTINOMYCIN" THEN "SPECTINOMYCIN"
    WHEN ${TABLE}.amr_genes = "ant(3'')-IIa" AND ${drug_classes} = "AMINOGLYCOSIDE" AND ${subclasses} = "SPECTINOMYCIN/STREPTOMYCIN" THEN "SPECTINOMYCIN/STREPTOMYCIN"
    WHEN ${drug_classes} = "AMINOGLYCOSIDE" AND ${subclasses} = "STREPTOMYCIN" AND(STARTS_WITH(${TABLE}.amr_genes, "aad") OR ${TABLE}.amr_genes = "ant(6)-Ia" OR ${TABLE}.amr_genes = "aph(3'')-Ib" OR ${TABLE}.amr_genes = "aph(6)-Id") THEN "STREPTOMYCIN"
    WHEN ${TABLE}.amr_genes = "sat2" AND ${drug_classes} = "STREPTOTHRICIN" AND ${subclasses} = "STREPTOTHRICIN" THEN "STREPTOTHRICIN"
    WHEN STARTS_WITH(${TABLE}.amr_genes, "sul") IS TRUE AND ${drug_classes} = "SULFONAMIDE" AND ${subclasses} = "SULFONAMIDE" THEN "SULFONAMIDE"
    WHEN STARTS_WITH(${TABLE}.amr_genes, "tet") IS TRUE AND ${drug_classes} = "TETRACYCLINE" AND ${subclasses} = "TETRACYCLINE" THEN "TETRACYCLINE"
    WHEN ${TABLE}.amr_genes = "aac(6')-Iz" AND ${drug_classes} = "AMINOGLYCOSIDE" AND ${subclasses} = "TOBRAMYCIN" THEN "TOBRAMYCIN"
    WHEN STARTS_WITH(${TABLE}.amr_genes, "dfr") IS TRUE AND ${drug_classes} = "TRIMETHOPRIM" AND ${subclasses} = "TRIMETHOPRIM" THEN "TRIMETHOPRIM"
    ELSE "Other" END;;
drill_fields: [amr_genes]
}

dimension: drug_classes {
type: string
sql: CASE
      WHEN ${TABLE}.amr_genes = "abaF" AND ${drug_class} = "FOSFOMYCIN" THEN "FOSFOMYCIN"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "fos") IS TRUE AND ${drug_class} = "FOSFOMYCIN" THEN "FOSFOMYCIN"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "aac(6')-Ib-cr") IS TRUE AND ${drug_class} = "AMINOGLYCOSIDE/QUINOLONE" THEN "AMINOGLYCOSIDE/QUINOLONE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "aph") IS TRUE AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "aad") IS TRUE AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "rmt") IS TRUE AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN ${TABLE}.amr_genes = "armA" AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "ant") IS TRUE AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN ${TABLE}.amr_genes = "aac(6')" AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "aac(6')-II") IS TRUE AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "aac(3)") IS TRUE AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN ${TABLE}.amr_genes = "aac(6')-Ib3" AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN ${TABLE}.amr_genes = "aac(6')-Il" AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN ${TABLE}.amr_genes = "aac(6')-Ib4" AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "aac(6')-29") IS TRUE AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN ${TABLE}.amr_genes = "aac(6')-Ib'" AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN ${TABLE}.amr_genes = "aac(6')-Ib" AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN ${TABLE}.amr_genes = "aac(6')-Iz" AND ${drug_class} = "AMINOGLYCOSIDE" THEN "AMINOGLYCOSIDE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "bla") IS TRUE AND ${drug_class} = "BETA-LACTAM" THEN "BETA-LACTAM"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "mec") IS TRUE AND ${drug_class} = "BETA-LACTAM" THEN "BETA-LACTAM"
      WHEN ${TABLE}.amr_genes = "ble" AND ${drug_class} = "BLEOMYCIN" THEN "BLEOMYCIN"
      WHEN ${TABLE}.amr_genes = "mcr-9.1" AND ${drug_class} = "COLISTIN" THEN "COLISTIN"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "sde") IS TRUE AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN ${TABLE}.amr_genes = "smfY" AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN ${TABLE}.amr_genes = "mepA" AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "mex") IS TRUE AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN ${TABLE}.amr_genes = "amvA" AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN ${TABLE}.amr_genes = "adeC" AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "emr") IS TRUE AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN ${TABLE}.amr_genes = "smeF" AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN ${TABLE}.amr_genes = "mdtM" AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN ${TABLE}.amr_genes = "acrF" AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN ${TABLE}.amr_genes = "kdeA" AND ${drug_class} = "EFFLUX" THEN "EFFLUX"
      WHEN ${TABLE}.amr_genes = "crpP" AND ${drug_class} = "FLUOROQUINOLONE" THEN "FLUOROQUINOLONE"
      WHEN ${TABLE}.amr_genes = "lsa(A)" AND ${drug_class} = "LINCOSAMIDE/STREPTOGRAMIN" THEN "LINCOSAMIDE/STREPTOGRAMIN"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "mph") IS TRUE AND ${drug_class} = "MACROLIDE" THEN "MACROLIDE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "msr") IS TRUE AND ${drug_class} = "MACROLIDE" THEN "MACROLIDE"
      WHEN STARTS_WITH(${TABLE}.amr_geneS, "erm") IS TRUE AND ${drug_class} = "MACROLIDE" THEN "MACROLIDE"
      WHEN ${TABLE}.amr_genes = "ere(A)" AND ${drug_class} = "MACROLIDE" THEN "MACROLIDE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "cat") IS TRUE AND ${drug_class} = "PHENICOL" THEN "PHENICOL"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "cmlA") IS TRUE AND ${drug_class} = "PHENICOL" THEN "PHENICOL"
      WHEN ${TABLE}.amr_genes = "floR" AND ${drug_class} = "PHENICOL" THEN "PHENICOL"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "oqx") IS TRUE AND ${drug_class} = "PHENICOL/QUINOLONE" THEN "PHENICOL/QUINOLONE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "qnr") IS TRUE AND ${drug_class} = "QUINOLONE" THEN "QUINOLONE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "qepA") IS TRUE AND ${drug_class} = "QUINOLONE" THEN "QUINOLONE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "arr") IS TRUE AND ${drug_class} = "RIFAMYCIN" THEN "RIFAMYCIN"
      WHEN ${TABLE}.amr_genes = "sat2" AND ${drug_class} = "STREPTOTHRICIN" THEN "STREPTOTHRICIN"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "sul") IS TRUE AND ${drug_class} = "SULFONAMIDE" THEN "SULFONAMIDE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "tet") IS TRUE AND ${drug_class} = "TETRACYCLINE" THEN "TETRACYCLINE"
      WHEN STARTS_WITH(${TABLE}.amr_genes, "dfr") IS TRUE AND ${drug_class} = "TRIMETHOPRIM" THEN "TRIMETHOPRIM"
      ELSE "Other" END ;;
drill_fields: [amr_genes]
}
